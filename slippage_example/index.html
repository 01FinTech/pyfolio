<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Quantopian Inc.">
        
        <link rel="shortcut icon" href="../img/favicon.ico">

	<title>Slippage analysis - pyfolio</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="..">pyfolio</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Overview</a>
                    </li>
                
                
                
                    <li >
                        <a href="../whatsnew/">Releases</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorial <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../single_stock_example/">Single stock</a>
</li>

                        
                            
<li >
    <a href="../zipline_algo_example/">Zipline algorithm</a>
</li>

                        
                            
<li >
    <a href="../bayesian/">Bayesian analysis</a>
</li>

                        
                            
<li >
    <a href="../sector_mapping_example/">Sector analysis</a>
</li>

                        
                            
<li >
    <a href="../round_trip_example/">Round trip analysis</a>
</li>

                        
                            
<li class="active">
    <a href="./">Slippage analysis</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../round_trip_example/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li class="disabled">
                        <a rel="prev" >
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/quantopian/pyfolio">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#slippage-analysis">Slippage Analysis</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="slippage-analysis">Slippage Analysis</h1>
<p>When evaluating a strategy using backtest results, we often want to know how sensitive it's performance is to implementation shortfall or slippage. pyfolio's transactions tear sheet can create "slippage sweep" plots that display strategy performance under various slippage assumptions. </p>
<p>Additional per-dollar slippage can be applied to returns before running a tear sheet by providing <code>create_full_tearsheet</code> with the a level of slippage in basis points (1% == 100 basis points) as the <code>slippage</code> keyword argument. The slippage plots in the transactions tear sheet will display returns with slippage added to the <strong>unadjusted</strong> returns. </p>
<p>For example, if you run a backtest with no transaction costs and call <code>create_full_tearsheet(returns, positions, transactions, slippage=5)</code>, 5 bps of slippage will be applied to <code>returns</code> before all plots and figures, with the exception of the slippage sweep plots, are generated.</p>
<p>It is important to emphasize that the slippage plots will display performance under <strong>additional</strong> slippage. If the passed performance data already has slippage applied, the 5 bps slippage equity curve will represent performance under 5 bps of slippage in addition to the already simulated slippage penalty. If slippage is already applied to the performance results, pass <code>slippage=0</code> to the <code>create_full_tearsheet</code> to trigger the creation of the additional slippage sweep plots without applying any additional slippage to the returns time series used throughout the rest of the tear sheet.</p>
<pre><code class="python">%matplotlib inline
import pyfolio as pf
import gzip
import pandas as pd
</code></pre>

<pre><code class="python">transactions = pd.read_csv(gzip.open('../tests/test_data/test_txn.csv.gz'),
                    index_col=0, parse_dates=0)
positions = pd.read_csv(gzip.open('../tests/test_data/test_pos.csv.gz'),
                    index_col=0, parse_dates=0)
returns = pd.read_csv(gzip.open('../tests/test_data/test_returns.csv.gz'),
                    index_col=0, parse_dates=0, header=None)[1]
gross_lev = pd.read_csv(gzip.open('../tests/test_data/test_gross_lev.csv.gz'),
                    index_col=0, parse_dates=0, header=None)[1]
returns.index = returns.index.tz_localize(&quot;UTC&quot;)
positions.index = positions.index.tz_localize(&quot;UTC&quot;)
transactions.index = transactions.index.tz_localize(&quot;UTC&quot;)
gross_lev.index = gross_lev.index.tz_localize(&quot;UTC&quot;)
</code></pre>

<pre><code class="python">pf.create_full_tear_sheet(returns, positions, transactions, gross_lev=gross_lev, slippage=0)
</code></pre>

<pre><code>Entire data start date: 2004-01-09
Entire data end date: 2009-12-31


Backtest Months: 71
</code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Performance statistics</th>
      <th>Backtest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>annual_return</th>
      <td>0.09</td>
    </tr>
    <tr>
      <th>annual_volatility</th>
      <td>0.26</td>
    </tr>
    <tr>
      <th>sharpe_ratio</th>
      <td>0.45</td>
    </tr>
    <tr>
      <th>calmar_ratio</th>
      <td>0.15</td>
    </tr>
    <tr>
      <th>stability_of_timeseries</th>
      <td>-0.04</td>
    </tr>
    <tr>
      <th>max_drawdown</th>
      <td>-0.60</td>
    </tr>
    <tr>
      <th>omega_ratio</th>
      <td>1.09</td>
    </tr>
    <tr>
      <th>sortino_ratio</th>
      <td>0.66</td>
    </tr>
    <tr>
      <th>skew</th>
      <td>0.14</td>
    </tr>
    <tr>
      <th>kurtosis</th>
      <td>5.88</td>
    </tr>
    <tr>
      <th>tail_ratio</th>
      <td>0.99</td>
    </tr>
    <tr>
      <th>common_sense_ratio</th>
      <td>1.08</td>
    </tr>
    <tr>
      <th>information_ratio</th>
      <td>0.03</td>
    </tr>
    <tr>
      <th>alpha</th>
      <td>0.08</td>
    </tr>
    <tr>
      <th>beta</th>
      <td>0.83</td>
    </tr>
  </tbody>
</table>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Worst Drawdown Periods</th>
      <th>net drawdown in %</th>
      <th>peak date</th>
      <th>valley date</th>
      <th>recovery date</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>60.39</td>
      <td>2007-11-06</td>
      <td>2009-03-09</td>
      <td>NaT</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>24.10</td>
      <td>2005-07-28</td>
      <td>2006-09-07</td>
      <td>2007-05-22</td>
      <td>474</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11.89</td>
      <td>2004-06-25</td>
      <td>2004-08-12</td>
      <td>2004-11-05</td>
      <td>96</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10.87</td>
      <td>2004-11-15</td>
      <td>2005-04-18</td>
      <td>2005-07-14</td>
      <td>174</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.51</td>
      <td>2007-07-16</td>
      <td>2007-08-06</td>
      <td>2007-09-13</td>
      <td>44</td>
    </tr>
  </tbody>
</table>

<pre><code>[-0.033 -0.072]
</code></pre>
<p><img alt="png" src="../slippage_example_files/slippage_example_4_4.png" /></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Stress Events</th>
      <th>mean</th>
      <th>min</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Lehmann</th>
      <td>-0.27%</td>
      <td>-4.70%</td>
      <td>4.11%</td>
    </tr>
    <tr>
      <th>Aug07</th>
      <td>0.32%</td>
      <td>-2.96%</td>
      <td>2.92%</td>
    </tr>
    <tr>
      <th>Mar08</th>
      <td>-0.43%</td>
      <td>-3.26%</td>
      <td>3.36%</td>
    </tr>
    <tr>
      <th>Sept08</th>
      <td>-0.68%</td>
      <td>-4.38%</td>
      <td>4.08%</td>
    </tr>
    <tr>
      <th>2009Q1</th>
      <td>-0.36%</td>
      <td>-5.02%</td>
      <td>3.39%</td>
    </tr>
    <tr>
      <th>2009Q2</th>
      <td>0.74%</td>
      <td>-4.03%</td>
      <td>6.13%</td>
    </tr>
    <tr>
      <th>Low Volatility Bull Market</th>
      <td>0.01%</td>
      <td>-6.07%</td>
      <td>6.43%</td>
    </tr>
    <tr>
      <th>GFC Crash</th>
      <td>-0.09%</td>
      <td>-11.76%</td>
      <td>10.13%</td>
    </tr>
    <tr>
      <th>Recovery</th>
      <td>0.35%</td>
      <td>-4.03%</td>
      <td>6.01%</td>
    </tr>
  </tbody>
</table>

<p><img alt="png" src="../slippage_example_files/slippage_example_4_6.png" /></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Top 10 long positions of all time</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>COST</th>
      <td>90.01%</td>
    </tr>
    <tr>
      <th>DELL</th>
      <td>85.73%</td>
    </tr>
    <tr>
      <th>CERN</th>
      <td>83.53%</td>
    </tr>
    <tr>
      <th>MMM</th>
      <td>82.09%</td>
    </tr>
    <tr>
      <th>INTC</th>
      <td>78.59%</td>
    </tr>
    <tr>
      <th>AMD</th>
      <td>75.76%</td>
    </tr>
    <tr>
      <th>GPS</th>
      <td>62.24%</td>
    </tr>
  </tbody>
</table>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Top 10 short positions of all time</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AMD</th>
      <td>-30.12%</td>
    </tr>
    <tr>
      <th>DELL</th>
      <td>-26.58%</td>
    </tr>
    <tr>
      <th>CERN</th>
      <td>-25.51%</td>
    </tr>
    <tr>
      <th>MMM</th>
      <td>-22.62%</td>
    </tr>
    <tr>
      <th>GPS</th>
      <td>-20.09%</td>
    </tr>
    <tr>
      <th>INTC</th>
      <td>-18.47%</td>
    </tr>
    <tr>
      <th>COST</th>
      <td>-16.44%</td>
    </tr>
  </tbody>
</table>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Top 10 positions of all time</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>COST</th>
      <td>90.01%</td>
    </tr>
    <tr>
      <th>DELL</th>
      <td>85.73%</td>
    </tr>
    <tr>
      <th>CERN</th>
      <td>83.53%</td>
    </tr>
    <tr>
      <th>MMM</th>
      <td>82.09%</td>
    </tr>
    <tr>
      <th>INTC</th>
      <td>78.59%</td>
    </tr>
    <tr>
      <th>AMD</th>
      <td>75.76%</td>
    </tr>
    <tr>
      <th>GPS</th>
      <td>62.24%</td>
    </tr>
  </tbody>
</table>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>All positions ever held</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>COST</th>
      <td>90.01%</td>
    </tr>
    <tr>
      <th>DELL</th>
      <td>85.73%</td>
    </tr>
    <tr>
      <th>CERN</th>
      <td>83.53%</td>
    </tr>
    <tr>
      <th>MMM</th>
      <td>82.09%</td>
    </tr>
    <tr>
      <th>INTC</th>
      <td>78.59%</td>
    </tr>
    <tr>
      <th>AMD</th>
      <td>75.76%</td>
    </tr>
    <tr>
      <th>GPS</th>
      <td>62.24%</td>
    </tr>
  </tbody>
</table>

<p><img alt="png" src="../slippage_example_files/slippage_example_4_11.png" /></p>
<p><img alt="png" src="../slippage_example_files/slippage_example_4_12.png" /></p></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
